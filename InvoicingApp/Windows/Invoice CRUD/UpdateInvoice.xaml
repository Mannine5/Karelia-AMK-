<Window x:Class="InvoicingApp.UpdateInvoice"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:InvoicingApp"
        mc:Ignorable="d"
        Title="UpdateInvoice" Height="1085" Width="780">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="80"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="*"/>

        </Grid.RowDefinitions>

        <!--Select Invoice-->
        <Canvas>
            <Label Content="Select Invoice" Canvas.Left="20" Canvas.Top="20" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Top" />

            <ComboBox Name="InvoiceComboBox" Canvas.Left="165" Canvas.Top="22.5" Height="35" Width="250" FontSize="20" SelectionChanged="InvoiceComboBox_SelectionChanged" HorizontalAlignment="Left" VerticalAlignment="Top">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding InvoiceId, StringFormat='ID {0}: '}"/>
                            <TextBlock Text="{Binding Customer.Name}"/>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <Button Content="Save" Canvas.Right="130" Canvas.Top="20" Height="40" Width="100" FontSize="20" Click="SaveClicked" />
            <Button Content="Cancel" Canvas.Right="20" Canvas.Top="20" Height="40" Width="100" FontSize="20" Click="CancelClicked" />
        </Canvas>

        <GridSplitter Grid.Row="1" Height="3" HorizontalAlignment="Center" Width="760" Background="Gray" />

        <!--Main Content-->
        <TextBlock Grid.Row="2" x:Name="LoadingMessage"
                   Text="Loading Invoices..."
                   FontSize="30"
                   Foreground="Gray"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Visibility="Collapsed"/>

        <TextBlock Grid.Row="2" x:Name="NoInvoicesMessage"
                   Text="No Invoices"
                   FontSize="30"
                   Foreground="Gray"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Visibility="Collapsed"/>

        <ContentControl Grid.Row="2" x:Name="MainContent">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="2.6*"/>
                    <RowDefinition Height="1.7*"/>
                    <RowDefinition Height="1.1*"/>
                    <RowDefinition Height="80"/>

                </Grid.RowDefinitions>

                <!--1. Section-->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!--1.1 Section-->
                    <StackPanel Margin="20,20,0,0">

                        <!--Rakennus Oy Header-->
                        <TextBlock Text="Rakennus Oy" FontSize="40" FontWeight="Bold" />

                        <!--Rakennus Oy Details-->
                        <StackPanel>
                            <TextBlock Text="Street Address" FontSize="20"/>
                            <TextBlock Text="City, State, Country" FontSize="20"/>
                            <TextBlock Text="Zip Code" FontSize="20"/>
                            <TextBlock Text="Phone Number" FontSize="20"/>
                            <TextBlock Text="Email" FontSize="20"/>
                        </StackPanel>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                            </Grid.ColumnDefinitions>


                            <StackPanel Margin="0,30,0,0">

                                <!--Bill To Header-->
                                <TextBlock Text="Bill To" FontSize="40" FontWeight="Bold"/>

                                <!--Bill To Details-->
                                <StackPanel>
                                    <TextBlock Text="Customer Name:" FontSize="20"/>
                                    <TextBlock Text="Street Address:" FontSize="20"/>
                                    <TextBlock Text="Postal Code:" FontSize="20"/>
                                    <TextBlock Text="City:" FontSize="20"/>
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Margin="0,83,0,0">

                                <TextBox Name="CustomerNameTextBox" Text="{Binding DisplayedInvoice.Customer.Name}" Height="26.6" FontSize="18"/>
                                <TextBox Name="StreetAddressTextBox" Text="{Binding DisplayedInvoice.Customer.StreetAddress}" Height="26.6" FontSize="18"/>
                                <TextBox Name="PostalCodeTextBox" Text="{Binding DisplayedInvoice.Customer.PostalCode}" Height="26.6" FontSize="18"/>
                                <TextBox Name="CityTextBox" Text="{Binding DisplayedInvoice.Customer.City}" Height="26.6" FontSize="18"/>
                            </StackPanel>
                        </Grid>

                    </StackPanel>

                    <!--1.2 Section-->
                    <Grid Grid.Column="1" Margin="20,0,20,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="153"/>
                            <RowDefinition Height="83"/>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <StackPanel Margin="0,20,0,0">
                            <!--Invoice Header-->
                            <TextBlock Text="Invoice" FontSize="40" FontWeight="Bold"/>
                            
                            <Grid >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*"/>
                                    <ColumnDefinition Width="1.5*"/>
                                </Grid.ColumnDefinitions>

                                <!--Invoice Details-->
                                <StackPanel>
                                    <TextBlock Text="Invoice No:" FontSize="20"/>
                                    <TextBlock Text="Invoice Date:" FontSize="20"/>
                                    <TextBlock Text="Due Date:" FontSize="20"/>
                                </StackPanel>

                                <!--Invoice Details Input-->
                                <StackPanel Grid.Column="1" >
                                    <TextBox Text="{Binding DisplayedInvoice.InvoiceId}" Height="27" FontSize="18"/>

                                    <!-- DatePicker for Invoice Date -->
                                    <DatePicker Name="InvoiceDatePicker" SelectedDate="{Binding DisplayedInvoice.InvoiceDate}" Height="27" FontSize="18">
                                        <DatePicker.Resources>
                                            <Style TargetType="DatePickerTextBox">
                                                <Setter Property="IsReadOnly" Value="True"/>
                                            </Style>
                                        </DatePicker.Resources>
                                    </DatePicker>

                                    <!-- DatePicker for Invoice Date -->
                                    <DatePicker Name="DueDatePicker" SelectedDate="{Binding DisplayedInvoice.DueDate}" Height="27" FontSize="18">
                                        <DatePicker.Resources>
                                            <Style TargetType="DatePickerTextBox">
                                                <Setter Property="IsReadOnly" Value="True"/>
                                            </Style>
                                        </DatePicker.Resources>
                                    </DatePicker>
                                </StackPanel>
                            </Grid>
                        </StackPanel>

                        <Grid Grid.Row="1" >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1.5*"/>
                            </Grid.ColumnDefinitions>

                            <!--Notes-->
                            <TextBlock Text="Notes:" FontSize="20"/>
                            <TextBox Name="NotesTextBox" Grid.Column="1" Text="{Binding DisplayedInvoice.Notes}" FontSize="18" TextWrapping="Wrap"/>
                        </Grid>

                        <!--Total Price-->
                        <StackPanel Grid.Row="2">
                            <TextBlock Text="Total Price:" FontSize="40" FontWeight="Bold" />
                            <TextBlock Text="{Binding TotalPrice, StringFormat='{}{0:F2} €'}" FontSize="40" FontWeight="Bold"/>
                            <TextBlock Text="(Press Enter to add row)" FontSize="14" HorizontalAlignment="Right" Margin="0,60,28,0"/>
                        </StackPanel>
                    </Grid>
                </Grid>

                <Grid Grid.Row="1" Margin="20,0,20,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>

                    </Grid.RowDefinitions>

                    <!--Product Data Grid-->
                    <DataGrid Name="ProductGrid" 
                              ItemsSource="{Binding ProductRows}" 
                              HeadersVisibility="Column" 
                              CanUserAddRows="True" 
                              AutoGenerateColumns="False" 
                              CellEditEnding="ProductGrid_CellEditEnding" 
                              KeyDown="ProductGrid_KeyDown">
                        <DataGrid.Columns >

                            <DataGridComboBoxColumn x:Name="ProductComboBox"
                                                    Header="Product Name" 
                                                    Width="140"
                                                    DisplayMemberPath="Name" 
                                                    SelectedValuePath="ProductId" 
                                                    SelectedValueBinding="{Binding ProductId}"
                                                    />    

                            <DataGridTextColumn Header="Description" Width="*" Binding="{Binding Description}"/>
                            <DataGridTextColumn Header="Unit Price" Width="70" Binding="{Binding UnitPrice}"/>
                            <DataGridTextColumn Header="Quantity" Width="80" Binding="{Binding Quantity}"/>

                            <DataGridTemplateColumn Width="25">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="X" Click="DeleteProductRow" Tag="{Binding}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!--Work Data Grid-->
                    <DataGrid Name="WorkGrid" Grid.Row="2" 
                              ItemsSource="{Binding WorkRows}" 
                              HeadersVisibility="Column" 
                              CanUserAddRows="True" 
                              AutoGenerateColumns="False" 
                              CellEditEnding="WorkGrid_CellEditEnding" 
                              KeyDown="WorkGrid_KeyDown">
                        <DataGrid.Columns>

                            <DataGridTextColumn Header="Work Description" Width="*" Binding="{Binding Description}"/>
                            <DataGridTextColumn x:Name="HourCostTextBox" Header="Hour Cost" Width="70" Binding="{Binding HourCost}"/>
                            <DataGridTextColumn x:Name="WorkHoursTextBox" Header="Work Hours" Width="80" Binding="{Binding WorkHours}"/>

                            <DataGridTemplateColumn Width="25">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="X" Click="DeleteWorkRow" Tag="{Binding}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                </Grid>

                <!--3. Section-->
                <Grid Grid.Row="2" >

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!--3.1 Section-->
                    <StackPanel Margin="20,20,0,0">

                        <!-- Payment Information Header-->
                        <TextBlock Text="Payment Information" FontSize="20" FontWeight="Bold"/>

                        <!--Payment Information Details-->
                        <StackPanel>
                            <TextBlock Text="Rakennus Oy" FontSize="20" />
                            <TextBlock Text="Bank: Really Great Bank" FontSize="20" />
                            <TextBlock Text="Account No: 0123 4567 8901" FontSize="20" />
                        </StackPanel>
                    </StackPanel>

                    <!--3.2 Section-->
                    <StackPanel Grid.Column="1" Margin="20,20,0,0">

                        <!--Contact Person Header-->
                        <TextBlock Text="Contact Person" FontSize="20" FontWeight="Bold"/>

                        <!--Contact Person Details-->
                        <StackPanel>
                            <TextBlock Text="Chief Executive Officer" FontSize="20" />
                            <TextBlock Text="123 Anywhere St, Any City, ST 12345" FontSize="20" />
                            <TextBlock Text="+123-456-7890" FontSize="20" />
                            <TextBlock Text="hello@reallygreatsite.com" FontSize="20" />
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <!--Section 4-->
                <Canvas Grid.Row="3">
                    <Button Content="Save" Canvas.Right="130" Canvas.Top="20" Height="40" Width="100" FontSize="20" Click="SaveClicked"/>
                    <Button Content="Cancel" Canvas.Right="20" Canvas.Top="20" Height="40" Width="100" FontSize="20" Click="CancelClicked"/>
                </Canvas>
            </Grid>
        </ContentControl>
    </Grid>
</Window>